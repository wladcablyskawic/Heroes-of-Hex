<!DOCTYPE html>
<head>
    <title>Hex</title>
    <script src="hexagon.js"></script>
	<script src="events.js"></script>
	<script src="astar.js"></script>	
	<script src="animation.js"></script>	

</head>
<body>

	<canvas id="HexCanvas" width="1500" height="1000"></canvas>
    <script>
        var hexagonGrid = new HexagonGrid("HexCanvas", 30, 10,10, "odd-q");

		hexagonGrid.addObstacle(2,4,'blokada','nieprzebyte gory');
		hexagonGrid.addObstacle(2,2,'blokada','nieprzebyte gory');
		hexagonGrid.addObstacle(2,3,'blokada','przepasc');
		hexagonGrid.addObstacle(3,4,'blokada','przepasc');		
		hexagonGrid.addObstacle(4,5,'blokada','nieprzebyte gory');
		hexagonGrid.addObstacle(3,1,'blokada','nieprzebyte gory');
		hexagonGrid.addObstacle(4,1,'blokada','nieprzebyte gory');
		

		
		hexagonGrid.addMob('player1', 1,1,'mob1',1,'opis wojownika1. cechy: szybkosc=1');
		hexagonGrid.addMob('player1', 0,0,'mob2',8, 'opis wojownika 2. cechy: szybkosc=3');
		hexagonGrid.addMob('player1', 0,4,'mob3',2,'opis wojownika 3. cechy: szybkosc=2');

		hexagonGrid.addMob('player2', 6,0,'enemy1',1,'opis przeciwnika1. cechy: szybkosc=1');
		hexagonGrid.addMob('player2', 7,2,'enemy2',3, 'opis przeciwnika 2. cechy: szybkosc=3');
		hexagonGrid.addMob('player2', 6,4,'enemy3',2,'opis przeciwnika 3. cechy: szybkosc=2');

		
		hexagonGrid.selectMob('mob2');
				
		window.onload = function(){
 var events = new Events("HexCanvas");
 var canvas = events.getCanvas();
 var context = events.getContext();
 var message = "";
 
 
 
 
 
 events.setStage(function() {
	this.clear();
    hexagonGrid.drawHexGrid(50, 50, true);

	for(var i=0; i<MOBS.length; i++) {
		this.beginRegion();
		if(MOBS[i].player=='player1') hexagonGrid.drawHexAtColRow(MOBS[i].Tile.column, MOBS[i].Tile.row,'blue', MOBS[i].name);
		else if(MOBS[i].player=='player2') hexagonGrid.drawHexAtColRow(MOBS[i].Tile.column, MOBS[i].Tile.row,'green', MOBS[i].name);
	 
		this.addRegionEventListener("mousemove", function(){
		if(MOBS[i].player=='player2') {
			if(checkLineOfSight(ACTIVE_MOB, MOBS[i])) {
				var mousePos = events.getMousePos();
				if(hexagonGrid.isChargePossible(ACTIVE_MOB, MOBS[i])) {
				var attackDirection=hexagonGrid.calculateAttackVector(mousePos.x, mousePos.y, MOBS[i].Tile);
				document.getElementById("HexCanvas").style.cursor = attackDirection+'-resize';	  			
				}				
			}
		}
		
		  
		  message = MOBS[i].hover;
		 });

		 this.addRegionEventListener("mouseout", function(){
		 document.getElementById("HexCanvas").style.cursor = "default";		  
				
		message = "";
		 });
		 

		 this.closeRegion();
 }
 
 	for(var i=0; i<OBSTACLES.length; i++) {
	
	this.beginRegion();
		hexagonGrid.drawHexAtColRow(OBSTACLES[i].Tile.column, OBSTACLES[i].Tile.row,'red', OBSTACLES[i].name);
		this.addRegionEventListener("mousemove", function(){
			message = OBSTACLES[i].hover;
		 });

		 this.addRegionEventListener("mouseout", function(){
			message = "";
		 });

		 this.closeRegion();
		
	}
	
	
	
	

	writeMessage(context, message);
 });

 // since we set the draw stage function, the listen()
 // method is automatically called for us

 function writeMessage(context, message){
 context.fillText(message, 10, 25);
 }

 };
		</script>

</body>
